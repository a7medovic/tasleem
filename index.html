<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>سلّم واستلم</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@400;600&family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app" data-offline="false">
    <header class="app-header">
      <div class="brand">
        <div class="logo" aria-hidden="true">S</div>
        <div class="brand-text">
          <h1>سلّم واستلم</h1>
          <span class="status-badge" role="status">جاهز للعمل</span>
        </div>
      </div>
      <button class="btn btn-primary" id="new-case-btn" accesskey="n">
        <span class="material-symbols-rounded" aria-hidden="true">add</span>
        تسليم جديد
      </button>
    </header>

    <main class="content" aria-live="polite">
      <section class="empty-state" id="empty-state" hidden>
        <div class="empty-message">
          <p>لا توجد حالات بعد. ابدأ بتسليم جديد.</p>
          <button class="btn btn-primary" id="empty-new-case">تسليم جديد</button>
        </div>
      </section>
      <section class="cases-grid" id="cases-list" role="list">
        <!-- Cards injected by script -->
      </section>
    </main>

    <div class="toast" role="status" aria-live="assertive" hidden></div>

    <aside class="slide-over" id="case-form" aria-hidden="true" aria-labelledby="case-form-title" role="dialog">
      <div class="slide-header">
        <h2 id="case-form-title">إضافة حالة جديدة</h2>
        <button class="icon-btn" data-close-slide aria-label="إغلاق">
          <span class="material-symbols-rounded">close</span>
        </button>
      </div>
      <form class="form" id="case-form-element">
        <label class="form-field">
          <span class="form-label">اسم الحالة</span>
          <input type="text" name="name" placeholder="اكتب اسم الحالة بالعربي" required />
        </label>
        <label class="form-field">
          <span class="form-label">تفاصيل الحالة</span>
          <div class="textarea-wrapper" data-state="idle">
            <textarea name="details" rows="6" placeholder="اضغط الميكروفون وتكلّم… أو اكتب التفاصيل هنا"></textarea>
            <button class="icon-btn mic-btn" type="button" aria-label="ابدأ التسجيل" data-mic>
              <span class="material-symbols-rounded" aria-hidden="true">mic</span>
            </button>
            <div class="voice-status" aria-live="polite">ابدأ التسجيل عند الضغط على الميكروفون</div>
          </div>
        </label>
        <div class="form-actions-inline">
          <button class="btn btn-ghost" type="button" id="clear-details">مسح</button>
          <button class="btn btn-secondary" type="button" id="manual-edit">تعديل يدوي</button>
          <button class="btn btn-success" type="button" id="dictation-complete" hidden>إرسال</button>
        </div>
        <div class="slide-footer">
          <button class="btn btn-primary" type="submit">حفظ</button>
          <button class="btn btn-ghost" type="button" data-close-slide>إلغاء</button>
        </div>
      </form>
    </aside>

    <div class="modal-overlay" id="modal-overlay" hidden></div>
    <section class="modal" id="case-modal" role="dialog" aria-modal="true" aria-labelledby="case-modal-title" hidden>
      <header class="modal-header">
        <button class="icon-btn" id="close-modal" aria-label="إغلاق">
          <span class="material-symbols-rounded">close</span>
        </button>
        <div class="incomplete-alert" role="alert">
          <span class="material-symbols-rounded" aria-hidden="true">warning</span>
          حقول ناقصة، يُفضّل استكمالها
        </div>
      </header>
      <div class="modal-content" tabindex="0">
        <div class="modal-top">
          <h3 id="case-modal-title" class="case-name">—</h3>
          <div class="case-age">—</div>
        </div>
        <div class="case-line">—</div>
        <div class="case-dates">
          <div class="case-date">LMP: —</div>
          <div class="case-date">EDD: —</div>
        </div>
        <div class="case-diagnosis">—</div>
        <div class="case-diagnosis-info">—</div>
        <div class="case-important">—</div>
        <div class="case-labs">—</div>
        <div class="case-todo">—</div>
      </div>
      <footer class="modal-actions">
        <button class="btn btn-secondary" id="edit-case">تعديل</button>
        <button class="btn btn-primary" id="save-case">حفظ</button>
        <button class="btn btn-danger" id="delete-case">حذف</button>
        <button class="btn btn-ghost" id="dismiss-modal">إغلاق</button>
      </footer>
    </section>

    <aside class="chat-panel" id="chat-panel" aria-hidden="true" role="dialog">
      <header>
        <h2>الدردشة الذكية</h2>
        <button class="icon-btn" data-close-chat aria-label="إغلاق">
          <span class="material-symbols-rounded">close</span>
        </button>
      </header>
      <div class="chat-body">
        <div class="bot-message">كيف يمكنني مساعدتك اليوم؟ ابحث عن حالة، تحليل، أو قرار.</div>
      </div>
      <form class="chat-input" id="chat-form">
        <input type="text" placeholder="اسأل عن أي حالة…" aria-label="رسالة" />
        <button class="icon-btn" type="submit" aria-label="إرسال">
          <span class="material-symbols-rounded">send</span>
        </button>
      </form>
    </aside>

    <div class="search-overlay" id="search-overlay" hidden role="dialog" aria-modal="true" aria-hidden="true">
      <div class="search-box">
        <label for="search-input" class="visually-hidden">بحث شامل</label>
        <input id="search-input" type="search" placeholder="ابحث في جميع الحقول" accesskey="/" />
        <button class="icon-btn" type="button" id="close-search" aria-label="إغلاق">
          <span class="material-symbols-rounded">close</span>
        </button>
      </div>
      <div class="search-results" role="list"></div>
    </div>

    <div class="fab-group fab-right">
      <button class="fab" id="chat-fab" aria-label="الدردشة الذكية" accesskey="c">
        <span class="material-symbols-rounded">chat_bubble</span>
      </button>
      <button class="fab" id="search-fab" aria-label="بحث شامل" accesskey="/">
        <span class="material-symbols-rounded">search</span>
      </button>
    </div>
    <div class="fab-group fab-left">
      <button class="fab" id="print-fab" aria-label="طباعة" accesskey="p">
        <span class="material-symbols-rounded">print</span>
      </button>
    </div>

    <div class="offline-badge" role="status" hidden>غير متصل</div>
  </div>

  <section class="print-layout" aria-hidden="true">
    <div class="print-grid" id="print-grid">
      <!-- print cards injected -->
    </div>
  </section>

  <script src="app.js" defer></script>
</body>
</html>
